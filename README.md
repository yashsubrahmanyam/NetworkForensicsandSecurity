# Network Forensics and Security

# Web Application Detection Building with Sumo Logic
This script detects Server-Side Request Forgery (SSRF) incidents. SSRFs are web vulnerabilities that an attacker can exploit to read or update internal resources. The attacker may supply or modify a URL, which the code running on our server then supplies data to (owasp.org). After selecting the URLs, the attacker may gain access to server configuration, such as AWS metadata, or connect to internal services, such as HTTP-enabled databases. 
SSRF attacks may cause chaos within an organization’s infrastructure. Many attacks result in the server connecting to internal-only services, but SSRFs may also force the server to connect to erratic external systems. 
In the typical SSRF attack against a server, the attacker triggers the application to make an HTTP request back to the server, where the application is hosted through its loopback network interface. This generally involves supplying a URL with a hostname such as 127.0.0.1, a reserved IP address pointing to the loopback adapter, or localhost, a commonly used name for the same adapter.

<img width="468" alt="image" src="https://github.com/user-attachments/assets/8a3e1f7f-fdec-46e0-8d0b-e3c71a035794">


The query utilizes the information provided to match URL entries that contain hostnames 127.0.0.1 or localhost. The results generated from this query can therefore be flagged as SSRF attempts attempting to access resources on the network loopback network interface of our server. In the next exploration, I continue down the Sumo Logic path and examine some brute force attacks.


# Identifying Brute Force Attack Login Attempts with Sumo Logic

Through Sumo Logic, we can identify attempted bruce force attack-based login attempts on Windows systems:
<img width="468" alt="image" src="https://github.com/user-attachments/assets/9198e025-76dd-4fde-90f4-25e815848302">

Event ID 4740 indicates an account lockout, which often occurs if a system detects a brute force attack attempt - particularly when the attacker tries too many passwords, and the account gets locked. This can inadvertently also lead to a DoS circumstance if many users are locked out due to brute force attack attempts. 
In this original code to determine audit log clearance, this is the outcome:

<img width="386" alt="image" src="https://github.com/user-attachments/assets/a0aca82e-b29f-4fb5-ab27-f1ab538dad68">

In the implementation of determining lockouts, we obtain an interesting result:

<img width="401" alt="image" src="https://github.com/user-attachments/assets/25462c7e-c3d3-47d0-89d5-b42bf825ce99">

The first computer in the first aggregated results section also appears in my implementation, suggesting that audit logs were cleared from that computer and a user account was locked out as well. This would escalate the criticality of that computer from medium-high to high urgency.

# User Security Detection in Sumo Logic: MitM attacks
This Sumo Logic query aims to detect man-in-the-middle (MitM) attacks. MitM attacks have various implications on user security, such as the interception of sensitive data, credential theft, or session hijacking, among other effects. 

The query is:

<img width="468" alt="image" src="https://github.com/user-attachments/assets/c993329e-7812-4eaa-a576-9eddc97d79a7">

This query aims to detect unusual SSH connections, in which public key authentication is accepted from a particular IP address. The attacker may intercept SSH traffic and attempt authentication using a stolen public key. In such an event, the SOC may raise an alert for further investigation. The “parse” command, derived in a similar fashion to the brute force attack query from the lab, extracts the username, IP address, and port number in successful public key-based SSH connections. This parse provides an instrumental starting point for detecting malicious MitM activity by detecting SSH connections.

# Cloud Security DDoS Detection 
This Sumo Logic query aids in detecting potential distributed denial of service (DDoS) attacks on the business’s cloud firewall. The uses the AWS CloudTrail source as the category, subsequently filtering for firewall-based incidents where incoming traffic exceeding 100MB within a 1-minute interval has been rejected. The results generated by this query can lend insight into a DDoS attempt. The threshold of 100MB has been selected albeit arbitrarily, although it is reasonably large enough not to be considered negligible. This can be altered to suit enterprise needs and average traffic patterns. An unusually large amount of incoming traffic can indicate a DDoS attack or attempt at such an attack on the enterprise’s services. The query is as follows:

<img width="468" alt="image" src="https://github.com/user-attachments/assets/65c69efc-234e-4515-b4d5-fc4c18763fb3">

In this query, we filter for firewall log entries where traffic is denied by the firewall, as this would block the DDoS attack at the firewall and aid a subsequent investigation in understanding the attack's origins. However, in the absence of a firewall, this query may still prove to be useful in determining the origins and nature of a DDoS attack once it has already taken place. 



